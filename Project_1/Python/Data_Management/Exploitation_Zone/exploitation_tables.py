from .boxOffice_table import *
from .imbd_tables import *
from .ml_tables import *

sys.path.append(os.path.abspath(os.path.join(os.path.dirname(__file__), '..')))
from utils import *

def exploitation_tables(boxoffice_delta_path='../../../Data Management/Trusted Zone/boxoffice/',
                        ml_movie_delta_path='../../../Data Management/Trusted Zone/ml-20m/', 
                        imbd_path='../../../Data Management/Trusted Zone/imbd/',
                        exploitation_zone_path='../../../Data Management/Exploitation Zone/'):
    try:
        spark = get_spark_session()
        boxOffice_table(spark, boxoffice_delta_path, exploitation_zone_path)
        ml_movie_tables(spark, ml_movie_delta_path, exploitation_zone_path)
        imbd_tables(spark, imbd_path, exploitation_zone_path)
        spark.stop()
    except Exception as e:
        print(f"Error: {e}")
        return False
    return True

# exploitation_tables()